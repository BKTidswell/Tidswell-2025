"0",""
"0","within_species_difference <- function(resp_var,base_formula, df, species){"
"0","  no_ab_form <- paste0(resp_var,"" ~ "",base_formula)"
"0","  ab_form <- paste0(resp_var,"" ~ Ablation+"",base_formula)"
"0","  "
"0","  group_1_no_ab <- lm(formula(no_ab_form), data = df %>% filter(Species == species))"
"0","  group_1_yes_ab <- lm(formula(ab_form), data = df %>% filter(Species == species))"
"0","  "
"0","  best_model <- rownames(AIC(group_1_yes_ab,group_1_no_ab) %>% arrange(AIC))[1]"
"0","  chi <- lrtest(group_1_yes_ab,group_1_no_ab)$Chisq[2]"
"0","  p_val <- lrtest(group_1_yes_ab,group_1_no_ab)$""Pr(>Chisq)""[2]"
"0","  "
"0","  return(tibble(ChiSqr = chi, PVal = p_val))"
"0","}"
"0",""
"0","within_species_difference_binom <- function(resp_var,base_formula, df, species){"
"0","  no_ab_form <- paste0(resp_var,"" ~ Group_Dist+"",base_formula)"
"0","  ab_form <- paste0(resp_var,"" ~ Ablation*Group_Dist+"",base_formula)"
"0","  "
"0","  group_1_no_ab <- glm(formula(no_ab_form), data = df %>% filter(Species == species), family = ""binomial"")"
"0","  group_1_yes_ab <- glm(formula(ab_form), data = df %>% filter(Species == species), family = ""binomial"")"
"0","  "
"0","  best_model <- rownames(AIC(group_1_yes_ab,group_1_no_ab) %>% arrange(AIC))[1]"
"0","  chi <- lrtest(group_1_yes_ab,group_1_no_ab)$Chisq[2]"
"0","  p_val <- lrtest(group_1_yes_ab,group_1_no_ab)$""Pr(>Chisq)""[2]"
"0","  "
"0","  return(tibble(ChiSqr = chi, PVal = p_val))"
"0","}"
"0",""
"0","nnd_contrasts <- rbind(within_species_difference(""NND"",""Trial"",school_data,""Giant Danio""),"
"0","                   within_species_difference(""NND"",""Trial"",school_data,""Cherry Barb""),"
"0","                   within_species_difference(""NND"",""Trial"",school_data,""Neon Tetra""))"
"0",""
"0","polar_contrasts <- rbind(within_species_difference(""School_Polar"",""Trial"",school_data,""Giant Danio""),"
"0","                     within_species_difference(""School_Polar"",""Trial"",school_data,""Cherry Barb""),"
"0","                     within_species_difference(""School_Polar"",""Trial"",school_data,""Neon Tetra""))"
"0",""
"0","speed_contrasts <- rbind(within_species_difference(""School_Speed"",""Trial"",school_data,""Giant Danio""),"
"0","                     within_species_difference(""School_Speed"",""Trial"",school_data,""Cherry Barb""),"
"0","                     within_species_difference(""School_Speed"",""Trial"",school_data,""Neon Tetra""))"
"0",""
"0","groups_contrasts <- rbind(within_species_difference(""Is_One"",""Trial"",group_sum_data_1_binom,""Giant Danio""),"
"0","                          within_species_difference(""Is_One"",""Trial"",group_sum_data_1_binom,""Cherry Barb""),"
"0","                          within_species_difference(""Is_One"",""Trial"",group_sum_data_1_binom,""Neon Tetra""))"
"0",""
"0","school_ablation_stats_table <- tibble(Stat = c(rep(""NND"",3),rep(""Polarization"",3),rep(""Speed"",3),rep(""Groups"",3)),"
"0","       Species = rep(c(""Giant Danio"",""Cherry Barb"",""Neon Tetra""), 4),"
"0","       X2 = round(c(nnd_contrasts$ChiSqr,polar_contrasts$ChiSqr,"
"0","                 speed_contrasts$ChiSqr,groups_contrasts$ChiSqr),2),"
"0","       P_Val = round(p.adjust(c(nnd_contrasts$PVal,polar_contrasts$PVal,"
"0","                 speed_contrasts$PVal,groups_contrasts$PVal), method = ""holm""),3),"
"0","       Is_Sig = P_Val < 0.05)"
"0",""
"0","school_ablation_stats_table"
