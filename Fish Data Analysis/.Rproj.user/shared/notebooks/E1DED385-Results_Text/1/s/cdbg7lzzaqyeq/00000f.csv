"0","school_data <- read.csv(""Data/Fish_School_Values_3D.csv"")"
"0","school_data <- na.omit(school_data)"
"0",""
"0","school_data <- school_data %>% mutate(Flow = ifelse(Flow == ""0"", ""Still Water"", ""Flowing Water (2 BL/s)"")) %>%"
"0","                           mutate(Ablation = ifelse(Ablation == ""N"", ""No Ablation"", ""Ablated"")) %>%"
"0","                           mutate(Darkness = ifelse(Darkness == ""N"", ""Light"", ""Dark"")) %>%"
"0","                           filter(School_Speed <= 5) %>%"
"0","                           mutate(Flow = factor(Flow), Ablation = factor(Ablation), Darkness = factor(Darkness)) %>%"
"0","                           mutate(Ablation = fct_relevel(Ablation, c(""No Ablation"",""Ablated""))) %>%"
"0","                           mutate(Ablation_Species = factor(paste(Ablation,Species,sep=""/n""))) %>%"
"0","                           mutate(Species = fct_relevel(Species, c(""Giant Danio"",""Cherry Barb"", ""Neon Tetra""))) %>%"
"0","                            "
"0","                           # ### Used to remove every third point to reduce autocorrelation"
"0","                           mutate(Date = paste(Year,Month,Day,sep=""_""),"
"0","                                  Date_Trial = paste(Year,Month,Day,Trial,sep=""_"")) %>%"
"0","                           group_by(Date_Trial) %>%"
"0","                           filter(row_number() %% 3 == 1) %>%"
"0","                           ungroup()"
"0",""
"0","all_fish_comp <- read.csv(""Data/Fish_Raw_Points_3D.csv"") %>% mutate(Flow = ifelse(Flow == ""0"", ""Still Water"", ""Flowing Water (2 BL/s)"")) %>%"
"0","                           mutate(Ablation = ifelse(Ablation == ""N"", ""No Ablation"", ""Ablated"")) %>%"
"0","                           mutate(Ablation = fct_relevel(Ablation, c(""No Ablation"",""Ablated""))) %>%"
"0","                           mutate(Species = fct_relevel(Species, c(""Giant Danio"",""Cherry Barb"", ""Neon Tetra""))) %>%"
"0","                           mutate(Ablation_Species = factor(paste(Ablation,Species,sep=""/n"")))"
"0",""
"0","#Uncomment with new data, takes a long time to run just for graph edits"
"0","# all_fish_comp_groups <- all_fish_comp %>% expand_grid(Group_Dist = seq(5,25,1)) %>%"
"0","#                                           group_by(Species, Ablation, Ablation_Species,"
"0","#                                                    Year, Month, Day, Trial, Tailbeat, Frame, Group_Dist) %>%"
"0","#                                           summarize(n_groups = get_n_groups(Head_X,Head_Y,Head_Z,Group_Dist)) %>%"
"0","#                                           ungroup() %>%"
"0","#                                           group_by(Species, Ablation, Ablation_Species,"
"0","#                                                    Year, Month, Day, Trial, Tailbeat, Group_Dist) %>%"
"0","#                                           summarize(Groups = as.integer(mean(n_groups, na.rm = TRUE))) %>%"
"0","#                                           ungroup() %>%"
"0","# "
"0","#                                            # ### Used to remove every third point to reduce autocorrelation"
"0","#                                            filter(Tailbeat %% 3 == 1) %>%"
"0","#                                           na.omit()"
"0","# saveRDS(all_fish_comp_groups, ""all_fish_comp_groups.RDS"")"
"0",""
"0","all_fish_comp_groups <- readRDS(""all_fish_comp_groups.RDS"")"
"0",""
"0",""
"0","group_sum_data <- all_fish_comp_groups %>% filter(Groups > 0) %>% group_by(Ablation, Species, Groups, Group_Dist) %>%"
"0","                            summarise(count = n()) %>%"
"0","                            ungroup() %>%"
"0","                            mutate(Groups = as.factor(Groups),"
"0","                                   Groups = fct_rev(Groups))"
"1","[38;5;232m`summarise()` has grouped output by 'Ablation', 'Species', 'Groups'. You can override using the `.groups` argument.[39m
"
"0","group_sum_data_1 <- group_sum_data %>% complete(Species,Ablation,Group_Dist,Groups,fill=list(count=0)) %>%"
"0","                                       group_by(Species,Ablation,Group_Dist) %>%"
"0","                                       mutate(total = sum(count),"
"0","                                              Percent_Group = count / total) %>%"
"0","                                       ungroup() %>%"
"0","                                       filter(Groups == 1)"
"0",""
"0","group_sum_data_1_binom <- all_fish_comp_groups %>% mutate(Is_One = ifelse(Groups == 1, 1, 0))"
