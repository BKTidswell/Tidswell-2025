"0","all_fish_comp <- read.csv(""Data/Fish_Raw_Points_3D.csv"") %>% mutate(Flow = ifelse(Flow == ""0"", ""Still Water"", ""Flowing Water (2 BL/s)"")) %>%"
"0","                           mutate(Ablation = ifelse(Ablation == ""N"", ""No Ablation"", ""Ablated"")) %>%"
"0","                           mutate(Ablation = fct_relevel(Ablation, c(""No Ablation"",""Ablated""))) %>%"
"0","                           mutate(Species = fct_relevel(Species, c(""Giant Danio"",""Cherry Barb"", ""Neon Tetra""))) %>%"
"0","                           mutate(Ablation_Species = factor(paste(Ablation,Species,sep=""/n"")))"
"0",""
"0","# #Uncomment with new data, takes a long time to run just for graph edits"
"0","# all_fish_comp_groups <- all_fish_comp %>% expand_grid(Group_Dist = seq(5,25,1)) %>%"
"0","#                                           group_by(Species, Ablation, Ablation_Species,"
"0","#                                                    Year, Month, Day, Trial, Tailbeat, Frame, Group_Dist) %>%"
"0","#                                           summarize(n_groups = get_n_groups(Head_X,Head_Y,Head_Z,Group_Dist)) %>%"
"0","#                                           ungroup() %>%"
"0","#                                           group_by(Species, Ablation, Ablation_Species,"
"0","#                                                    Year, Month, Day, Trial, Tailbeat, Group_Dist) %>%"
"0","#                                           summarize(Groups = as.integer(mean(n_groups, na.rm = TRUE))) %>%"
"0","#                                           ungroup() %>%"
"0","# "
"0","#                                            # ### Used to remove every third point to reduce autocorrelation"
"0","#                                            filter(Tailbeat %% 3 == 1) %>%"
"0","#                                           na.omit()"
"0","# saveRDS(all_fish_comp_groups, ""all_fish_comp_groups.RDS"")"
"0",""
"0","all_fish_comp_groups <- readRDS(""all_fish_comp_groups.RDS"")"
"0",""
"0","group_sum_data <- all_fish_comp_groups %>% filter(Groups > 0) %>% group_by(Ablation, Species, Groups, Group_Dist) %>%"
"0","                            summarise(count = n()) %>%"
"0","                            ungroup() %>%"
"0","                            mutate(Groups = as.factor(Groups),"
"0","                                   Groups = fct_rev(Groups))"
"1","[38;5;232m`summarise()` has grouped output by 'Ablation', 'Species', 'Groups'. You can override using the `.groups` argument.[39m
"
"0","group_sum_data_1 <- group_sum_data %>% complete(Species,Ablation,Group_Dist,Groups,fill=list(count=0)) %>%"
"0","                                       group_by(Species,Ablation,Group_Dist) %>%"
"0","                                       mutate(total = sum(count),"
"0","                                              Percent_Group = count / total) %>%"
"0","                                       ungroup() %>%"
"0","                                       filter(Groups == 1)"
"0",""
"0","group_sum_data_1_binom <- all_fish_comp_groups %>% mutate(Is_One = ifelse(Groups == 1, 1, 0))"
"0",""
"0","group_1_glm <- glm(Is_One ~ Ablation*Species*Group_Dist, data = group_sum_data_1_binom, family = ""binomial"")"
"0","group_1_aov <- Anova(group_1_glm, type=c(""III""))"
"0","group_1_aov"
"1","Analysis of Deviance Table (Type III tests)
"
"1","
"
"1","Response: Is_One"
"1","
"
"1","                           "
"1"," LR Chisq"
"1"," Df"
"1"," Pr(>Chisq)"
"1","    "
"1","
Ablation                   "
"1","    4.667"
"1","  1"
"1","    0.03074"
"1"," *  "
"1","
Species                    "
"1","   72.546"
"1","  2"
"1","  < 2.2e-16"
"1"," ***"
"1","
Group_Dist                 "
"1","  295.721"
"1","  1"
"1","  < 2.2e-16"
"1"," ***"
"1","
Ablation:Species           "
"1","   35.582"
"1","  2"
"1","  1.877e-08"
"1"," ***"
"1","
Ablation:Group_Dist        "
"1","    2.952"
"1","  1"
"1","    0.08578"
"1"," .  "
"1","
Species:Group_Dist         "
"1","  116.667"
"1","  2"
"1","  < 2.2e-16"
"1"," ***"
"1","
Ablation:Species:Group_Dist"
"1","  117.466"
"1","  2"
"1","  < 2.2e-16"
"1"," ***"
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1"
"1","
"
"0","group_still <- ggplot(group_sum_data_1, aes(Group_Dist, Percent_Group, color = Ablation))+"
"0","  facet_wrap(~Species)+"
"0","  geom_point()+"
"0","  geom_line(data = group_sum_data_1_binom, aes(x = Group_Dist, y = predict(group_1_glm, type=""response"")), size = 1) + "
"0","  scale_color_manual(values = c(light_no_ab_color,light_ab_color,dark_no_ab_color,dark_ab_color)) +"
"0","  theme(legend.position = ""none"")+"
"0","  xlab(""Maximum Distance to Connect Group (cm)"")+"
"0","  ylab(""Proportion of Time in 1 Group"")+"
"0","  scale_y_continuous(breaks = seq(0,1,0.25), limits = c(0,1))+"
"0","  theme_light()+"
"0","  #theme(legend.position = ""none"") +"
"0","  theme(axis.text.x = element_text(size = text_size),"
"0","        axis.text.y = element_text(size = text_size),"
"0","        axis.title.x = element_text(size = text_size),"
"0","        axis.title.y = element_text(size = text_size),"
"0","        strip.text.x = element_text(size = text_size))"
"0",""
"0","group_still"
