"0",""
"0","school_data_no_removals <- read.csv(""Data/Fish_School_Values_3D.csv"")"
"0","school_data_no_removals <- na.omit(school_data_no_removals)"
"0",""
"0","school_data_no_removals <- school_data_no_removals %>% mutate(Flow = ifelse(Flow == ""0"", ""Still Water"", ""Flowing Water (2 BL/s)"")) %>%"
"0","                           mutate(Ablation = ifelse(Ablation == ""N"", ""No Ablation"", ""Ablated"")) %>%"
"0","                           mutate(Darkness = ifelse(Darkness == ""N"", ""Light"", ""Dark"")) %>%"
"0","                           filter(School_Speed <= 5) %>%"
"0","                           mutate(Flow = factor(Flow), Ablation = factor(Ablation), Darkness = factor(Darkness)) %>%"
"0","                           mutate(Ablation = fct_relevel(Ablation, c(""No Ablation"",""Ablated""))) %>%"
"0","                           mutate(Ablation_Species = factor(paste(Ablation,Species,sep="", ""))) %>%"
"0","                           mutate(Date = paste(Year,Month,Day,sep=""_""),"
"0","                                  Date_Trial = paste(Year,Month,Day,Trial,sep=""_""),)"
"0",""
"0","for(i in seq(1:5)){"
"0","  print(i)"
"0","  "
"0","  new_autocorrs <- school_data_no_removals %>% group_by(Date_Trial) %>%"
"0","                         filter(!Date_Trial %in% c(""2021_3_25_30"",""2020_7_28_29"",""2021_10_6_34"","
"0","                                              ""2021_7_7_16"",""2021_3_25_7"",""2021_3_25_22"",""2024_4_2_2"",""2024_3_28_29"","
"0","                                              ""2021_8_3_8"",""2021_3_25_10"",""2024_3_28_32"",""2024_2_23_18"")) %>%"
"0","                    summarise(nnd_corr = abs(cor.test(NND, lag(NND, n = i))$estimate),"
"0","                              nnd_p = cor.test(NND, lag(NND, n = i))$p.value,"
"0","                              polar_corr = abs(cor.test(School_Polar, lag(School_Polar, n = i))$estimate),"
"0","                              polar_p = cor.test(School_Polar, lag(School_Polar, n = i))$p.value,"
"0","                              speed_corr = abs(cor.test(School_Speed, lag(School_Speed, n = i))$estimate),"
"0","                              speed_p = cor.test(School_Speed, lag(School_Speed, n = i))$p.value,"
"0","                              groups_corr = abs(cor.test(Groups, lag(Groups, n = i))$estimate),"
"0","                              groups_p = cor.test(Groups, lag(Groups, n = i))$p.value,"
"0","                              area_corr = abs(cor.test(Area, lag(Area, n = i))$estimate),"
"0","                              area_p = cor.test(Area, lag(Area, n = i))$p.value,"
"0","                              height_corr = abs(cor.test(School_Height, lag(School_Height, n = i))$estimate),"
"0","                              height_p = cor.test(School_Height, lag(School_Height, n = i))$p.value,"
"0","                              lag = i)"
"0","  "
"0","  if(i == 1){"
"0","    school_autocorrs <- new_autocorrs"
"0","  }"
"0","  else{"
"0","    school_autocorrs <- rbind(school_autocorrs,new_autocorrs) "
"0","  }"
"0","  "
"0","}"
"1","[1]"
"1"," 1"
"1","
"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"1","[1]"
"1"," 2"
"1","
"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"1","[1]"
"1"," 3"
"1","
"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"1","[1]"
"1"," 4"
"1","
"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"1","[1]"
"1"," 5"
"1","
"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"2","Warning: the standard deviation is zero"
"0","nnd_lag_plot <- ggplot(school_autocorrs, aes(as.factor(lag), nnd_corr))+"
"0","  stat_summary(fun.data = mean_se, geom = ""errorbar"", color = ""black"", width = 0.25) +"
"0","  stat_summary(fun.y=mean, geom=""point"", size = 3) +"
"0","  ylim(0,1)+"
"0","  ylab(""NND Autocorrelation"")+"
"0","  xlab(""Offset"")+"
"0","  theme_classic()+ "
"0","  theme(legend.position = ""none"")"
"2","Warning: The `fun.y` argument of `stat_summary()` is deprecated as of ggplot2 3.3.0.
Please use the `fun` argument instead."
"0","polar_lag_plot <- ggplot(school_autocorrs, aes(as.factor(lag), polar_corr))+"
"0","  stat_summary(fun.data = mean_se, geom = ""errorbar"", color = ""black"", width = 0.25) +"
"0","  stat_summary(fun.y=mean, geom=""point"", size = 3) +"
"0","  ylim(0,1)+"
"0","  ylab(""Polarity Autocorrelation"")+"
"0","  xlab(""Offset"")+"
"0","  theme_classic()+ "
"0","  theme(legend.position = ""none"")"
"0",""
"0","speed_lag_plot <- ggplot(school_autocorrs, aes(as.factor(lag), speed_corr))+"
"0","  stat_summary(fun.data = mean_se, geom = ""errorbar"", color = ""black"", width = 0.25) +"
"0","  stat_summary(fun.y=mean, geom=""point"", size = 3) +"
"0","  ylim(0,1)+"
"0","  ylab(""Speed Autocorrelation"")+"
"0","  xlab(""Offset"")+"
"0","  theme_classic()+ "
"0","  theme(legend.position = ""none"")"
"0",""
"0","groups_lag_plot <- ggplot(school_autocorrs, aes(as.factor(lag), groups_corr))+"
"0","  stat_summary(fun.data = mean_se, geom = ""errorbar"", color = ""black"", width = 0.25) +"
"0","  stat_summary(fun.y=mean, geom=""point"", size = 3) +"
"0","  ylim(0,1)+"
"0","  ylab(""Numebr of Groups Autocorrelation"")+"
"0","  xlab(""Offset"")+"
"0","  theme_classic()+ "
"0","  theme(legend.position = ""none"")"
"0",""
"0","lag_plots <- ggarrange("
"0","          nnd_lag_plot, polar_lag_plot, speed_lag_plot, groups_lag_plot,"
"0","          ncol = 2, nrow = 2,"
"0","          labels = c(""A"", ""B"", ""C"", ""D""))"
"2","Warning: [38;5;232mRemoved 12 rows containing non-finite values (`stat_summary()`).[39m"
"2","Warning: [38;5;232mRemoved 12 rows containing non-finite values (`stat_summary()`).[39m"
"0","ggsave(""Paper Figures/Different_Lag_Figures.png"", lag_plots, width = 7, height = 7)"
"0",""
